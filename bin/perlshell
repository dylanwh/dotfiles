#!/usr/bin/env perl
use strict;
use warnings;

use Term::ReadLine;
use Term::ANSIColor;

my $term = new Term::ReadLine("perlshell");
my $attr = $term->Attribs;
my $port;
my $ans;
my @words;

if (my $file = shift) {
    require $file;
}

$@ = undef;
# As long as the user wants to talk to us, we stay in this while-loop.
while (defined($ans = $term->readline(prompt('perl% ', 'reset green')))) {
    # The user doesn't want to stay here, so leave.
    if ($ans =~ /^\s*(quit|exit|bye)\s*$/) { last }

    chomp($ans);

    no strict;
    my $eval =  eval($ans);
    use strict;
    if (defined $eval) {
    print "$eval\n";
    }
    if (defined $@ and $@ ne "") {
    print "Error: $@";
    undef $@;
    }
}

print "Bye, till next time!\n";

sub prompt {
    my ($t, $c) = @_;
    return chr(1).color($c).chr(2).$t.chr(1).color('reset').chr(2);
}

# vim: ts=8 sts=4 sw=4 ft=perl
