#!/usr/bin/env perl
use strict;
use warnings;
use File::Basename;
use Getopt::Long qw( :config gnu_getopt );

my $TERM  = 'urxvt';
my ($name, $eep, $chdir );

foreach (@ARGV) {
    if ($_ eq '-e') {
        $_ = '--';
        last 
    }
    elsif (/^-name/) {
        $_ = '--name';
    }
    elsif (/^-e(.+)$/) {
        unshift @ARGV, "-$1" if $1;
        $_ = '--';
        last;
    } 
}

GetOptions(
    'name|n=s'  => \$name,
    'e'         => \$eep,
    'chdir|C=s' => \$chdir,
);

my (@run) = @ARGV;
chdir $chdir if $chdir;
unshift @run, '-e' if @run;

unless ($name) {
    if (@ARGV) {
        $name = $ARGV[0];
    }
}

run($TERM,
    $name ? (-name => $name) : (),
    @run
);

sub run { 
    exec(@_);
}
