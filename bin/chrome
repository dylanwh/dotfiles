#!/usr/bin/env perl
use strict;
use feature 'switch';

use Getopt::Long qw(:config gnu_getopt);

my $browser = 'google-chrome';
my (@options, $profile);

GetOptions('profile|p=s' => \$profile, 'browser|b=s' => \$browser);
my ($url) = @ARGV;

if (not defined $profile) {
    given ($url) {
        when (/iinteractive.com/) {
            $profile = 'work';
        }
    }
}
elsif ($profile eq 'default') {
    $profile = undef;
}

if ($profile) {
    push @options, '--user-data-dir=' . user_data_dir($profile);
}

fork or exec($browser, @options, $url);

sub user_data_dir {
    my $profile = shift;
    my $base = $ENV{XDG_CONFIG_HOME} || "$ENV{HOME}/.config";

    return "$base/google-chrome-$profile";
}
